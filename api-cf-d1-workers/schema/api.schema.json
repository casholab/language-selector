{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://lsapi.casholab.com/schema/api.schema.json",
  "title": "Casho Languages API Schema",
  "description": "JSON Schema for the Casho Languages API responses",
  "definitions": {
    "FlagMode": {
      "type": "string",
      "enum": ["none", "single", "all"],
      "description": "Flag display mode: 'none' (no flags), 'single' (primary flag only), 'all' (up to 4 flags)"
    },
    "LanguageData": {
      "type": "object",
      "description": "Core language information",
      "properties": {
        "code": {
          "type": "string",
          "description": "ISO 639-3 language code"
        },
        "name": {
          "type": "string",
          "description": "English name of the language"
        },
        "terminologyCode": {
          "type": "string",
          "description": "ISO 639-2/T terminology code"
        },
        "bibliographicCode": {
          "type": "string",
          "description": "ISO 639-2/B bibliographic code"
        },
        "twoLetterCode": {
          "type": "string",
          "description": "ISO 639-1 two-letter code"
        },
        "endonym": {
          "type": "string",
          "description": "Native name of the language"
        },
        "defaultDirection": {
          "type": ["string", "null"],
          "enum": ["ltr", "rtl", null],
          "description": "Default text direction"
        },
        "spacing": {
          "type": ["string", "null"],
          "description": "Spacing rules for the language"
        }
      },
      "required": ["code", "name", "terminologyCode", "bibliographicCode", "twoLetterCode", "endonym"]
    },
    "RegionData": {
      "type": "object",
      "description": "Region-specific language data",
      "properties": {
        "regionCode": {
          "type": "string",
          "description": "ISO 3166-1 alpha-2 region code"
        },
        "regionNameEnglish": {
          "type": "string",
          "description": "English name of the region"
        },
        "regionNameNative": {
          "type": "string",
          "description": "Native name of the region"
        },
        "languageNameInRegion": {
          "type": "string",
          "description": "Name of the language as used in this region"
        }
      },
      "required": ["regionCode", "regionNameEnglish", "regionNameNative", "languageNameInRegion"]
    },
    "ScriptData": {
      "type": "object",
      "description": "Script-specific language data",
      "properties": {
        "scriptVariant": {
          "type": "string",
          "description": "ISO 15924 script code"
        },
        "scriptNameEnglish": {
          "type": "string",
          "description": "English name of the script"
        },
        "scriptNameLocal": {
          "type": "string",
          "description": "Native name of the script"
        },
        "languageInScript": {
          "type": "string",
          "description": "Name of the language written in this script"
        }
      },
      "required": ["scriptVariant", "scriptNameEnglish", "scriptNameLocal", "languageInScript"]
    },
    "LanguageEntry": {
      "type": "object",
      "description": "Complete language entry with all associated data",
      "properties": {
        "data": {
          "$ref": "#/definitions/LanguageData"
        },
        "regionData": {
          "type": "object",
          "description": "Map of region codes to region data",
          "additionalProperties": {
            "$ref": "#/definitions/RegionData"
          }
        },
        "scriptData": {
          "type": "object",
          "description": "Map of script codes to script data",
          "additionalProperties": {
            "$ref": "#/definitions/ScriptData"
          }
        },
        "flags": {
          "type": "array",
          "description": "Primary flag country codes for this language",
          "items": {
            "type": "string"
          }
        },
        "scriptFlags": {
          "type": "object",
          "description": "Map of script codes to their associated flag country codes",
          "additionalProperties": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "required": ["data"]
    },
    "LanguageLookupResult": {
      "type": "object",
      "description": "Result of a language lookup request",
      "properties": {
        "data": {
          "type": "object",
          "description": "Map of language codes to language entries",
          "additionalProperties": {
            "$ref": "#/definitions/LanguageEntry"
          }
        },
        "resolved": {
          "type": "array",
          "description": "List of resolved BCP 47 language tags",
          "items": {
            "type": "string"
          }
        },
        "normalized": {
          "type": "object",
          "description": "Map of input strings to their normalized language codes",
          "additionalProperties": {
            "type": "string"
          }
        },
        "invalid": {
          "type": "array",
          "description": "List of inputs that could not be resolved",
          "items": {
            "type": "string"
          }
        },
        "flags": {
          "type": "object",
          "description": "Map of country codes to SVG flag data",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "required": ["data", "resolved", "normalized", "invalid"]
    },
    "LanguageSelectorOptions": {
      "type": "object",
      "description": "Configuration options for the language selector UI",
      "properties": {
        "buttonSize": {
          "type": "string",
          "enum": ["sm", "lg"],
          "description": "Size of the selector button"
        },
        "isModal": {
          "type": "boolean",
          "description": "Whether to display as a modal"
        },
        "isOpen": {
          "type": "boolean",
          "description": "Initial open state"
        },
        "confirmSelection": {
          "type": "boolean",
          "description": "Whether to require confirmation of selection"
        },
        "showEnglishName": {
          "type": "boolean",
          "description": "Whether to show English names alongside endonyms"
        },
        "flagMode": {
          "$ref": "#/definitions/FlagMode"
        }
      }
    },
    "StaticLanguageFile": {
      "type": "object",
      "description": "Complete static file for embedded language selector",
      "properties": {
        "meta": {
          "type": "object",
          "properties": {
            "generatedAt": {
              "type": "string",
              "format": "date-time",
              "description": "ISO 8601 timestamp of file generation"
            },
            "version": {
              "type": "string",
              "description": "API version used to generate this file"
            }
          },
          "required": ["generatedAt", "version"]
        },
        "options": {
          "$ref": "#/definitions/LanguageSelectorOptions"
        },
        "result": {
          "$ref": "#/definitions/LanguageLookupResult"
        }
      },
      "required": ["meta", "options", "result"]
    }
  },
  "oneOf": [
    {
      "title": "LanguageLookupResult",
      "description": "Response from /languages endpoint",
      "$ref": "#/definitions/LanguageLookupResult"
    },
    {
      "title": "StaticLanguageFile",
      "description": "Response from /languages/file endpoint",
      "$ref": "#/definitions/StaticLanguageFile"
    }
  ]
}

